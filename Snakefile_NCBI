from os.path import join

configfile: "config/config.yaml"

# get list of accession numbers from accession number file
with open(config["accessionNumFile"], 'r') as f:
    accession_num_file = f.read()
    ACCESSION_NUMBERS = accession_num_file.split()


rule all:
	input:
		# get tree info
		#"workflow/out/treeInfo/closestRefList.txt",
		#"workflow/out/treeInfo/closestRefInfo_allScoreThresholdHits.csv",
		#"workflow/out/treeInfo/queryDistanceInfo.csv",
		#"workflow/out/treeInfo/queryDistanceInfo.json",
		# get query IDs
		#"workflow/out/treeInfo/Anantharaman2018_queryIDs_inTree.txt",
		
		# remove bootstrap values
		#join(config["raxmlOutputDir"],"RAxML_labelledTree_noBootstrap.newick"),
		# fragment insertion (.Daigle2026_frag)
		#join(config["raxmlOutputDir"], f"RAxML_info.{config['treeFileExtension_frag']}"),
		#join(config["raxmlOutputDir"], f"RAxML_classification.{config['treeFileExtension_frag']}"),
		#join(config["raxmlOutputDir"], f"RAxML_classificationLikelihoodWeights.{config['treeFileExtension_frag']}"),
		#join(config["raxmlOutputDir"], f"RAxML_entropy.{config['treeFileExtension_frag']}"),
		#join(config["raxmlOutputDir"], f"RAxML_labelledTree.{config['treeFileExtension_frag']}"),
		#join(config["raxmlOutputDir"], f"RAxML_originalLabelledTree.{config['treeFileExtension_frag']}"),
		#join(config["raxmlOutputDir"], f"RAxML_portableTree.{config['treeFileExtension_frag']}"),
		# get model parameters (.Daigle2026)
		#join(config["modelParamsDir"], f"RAxML_binaryModelParameters.{config['treeFileExtension']}"),
		#join(config["modelParamsDir"], f"RAxML_result.{config['treeFileExtension']}"),
		# MSA that includes Anantharaman sequences
		#join(config["cleanHitsDir"],"compiled_dsrAB_scoreThreshold_noDups_msa_withRef_trimmedGaps_withAnantharaman2018Seqs.faa"),
		
		# final MSA
		#join(config["cleanHitsDir"], "compiled_dsrAB_scoreThreshold_noDups_msa_withRef_trimmedGaps.faa"),
		# trim gaps
		#join(config["cleanHitsDir"],"compiled_dsrAB_scoreThreshold_noDups_gapPercentageInfo.csv"),
		#join(config["cleanHitsDir"],"compiled_dsrAB_scoreThreshold_noDups_msa_noRef_trimmedGaps.faa"),
		# run MAFFT
		#join(config["cleanHitsDir"],"compiled_dsrAB_scoreThreshold_noDups_msa_withRef.faa"),
		#join(config["cleanHitsDir"],"compiled_dsrAB_scoreThreshold_noDups_msa_noRef.faa"),
		# removing dups
		#join(config["cleanHitsDir"], "compiled_dsrAB_hits_scoreThreshold_noDups.faa"),
		#join(config["cleanHitsDir"], "compiled_dsrAB_hits_scoreThreshold_noDups.json"),
		#join(config["cleanHitsDir"], "compiled_dsrAB_hits_scoreThreshold_noEDups.faa"),
		# compiling archaeal and bacterial hits
		#join(config["cleanHitsDir"],"compiled_dsrAB_hits_scoreThreshold.faa"),
		#join(config["cleanHitsDir"],"compiled_dsrAB_hits_scoreThreshold.csv"),
		# bit filtering
		#join(config["cleanHitsDir"],"compiled_dsrAB_bact_hits_scoreThreshold.csv"),
		#join(config["cleanHitsDir"],"compiled_dsrAB_arch_hits_scoreThreshold.csv"),
		#join(config["cleanHitsDir"],"compiled_dsrAB_bact_hits_scoreThreshold.faa"),
		#join(config["cleanHitsDir"],"compiled_dsrAB_arch_hits_scoreThreshold.faa"),
		
        # get compiled files (THIS IS WHERE YOU CAN START)
		#join(config["summaryDir"],"compiled_dsrAB_bact_hits.csv"),
        #join(config["summaryDir"],"compiled_dsrAB_arch_hits.csv"),
		#join(config["summaryDir"],"compiled_dsrAB_bact_hits.faa"),
        #join(config["summaryDir"],"compiled_dsrAB_arch_hits.faa"),
		# run Prodigal then run HMMER search of dsrAB on human gut metagenomic data
		#expand(join(config["prodigalGeneCoordDir"],"{accession_num}_geneCoord.out"), accession_num=ACCESSION_NUMBERS),
		#expand(join(config["prodigalProteinSeqDir"], "{accession_num}.faa"), accession_num=ACCESSION_NUMBERS),
		#expand(join(config["hmmOutDir"],"{accession_num}_dsrAB_bact.hmm.out"), accession_num=ACCESSION_NUMBERS),
		#expand(join(config["domtblDir"],"{accession_num}_dsrAB_bact.domtblout"), accession_num=ACCESSION_NUMBERS),
		#expand(join(config["hmmOutDir"],"{accession_num}_dsrAB_arch.hmm.out"), accession_num=ACCESSION_NUMBERS),
		#expand(join(config["domtblDir"],"{accession_num}_dsrAB_arch.domtblout"), accession_num=ACCESSION_NUMBERS),
		#expand(join(config["summaryDir"],"{accession_num}_dsrAB_bact_hits.csv"), accession_num=ACCESSION_NUMBERS),
		#expand(join(config["summaryDir"],"{accession_num}_dsrAB_arch_hits.csv"), accession_num=ACCESSION_NUMBERS),
		#expand(join(config["msaDir"],"sto/{accession_num}_dsrAB_bact.sto"), accession_num=ACCESSION_NUMBERS),
		#expand(join(config["msaDir"],"sto/{accession_num}_dsrAB_arch.sto"), accession_num=ACCESSION_NUMBERS),
		#expand(join(config["msaDir"],"faa/{accession_num}_dsrAB_bact.faa"), accession_num=ACCESSION_NUMBERS),
		#expand(join(config["msaDir"],"faa/{accession_num}_dsrAB_arch.faa"), accession_num=ACCESSION_NUMBERS),
		
		# download human gut metagenomic data from NCBI
		#expand(join(config["repositoryDir"],"{accession_num}"), accession_num=ACCESSION_NUMBERS),
		#expand(join(config["dumpDir"],"{accession_num}.fa"),accession_num=ACCESSION_NUMBERS),

		# get reference file without dups from Mueller 2015
		#"config/Anantharaman2018_dsrA_dsrB_noDups.faa",
		#"config/Anantharaman2018_dsrA_dsrB_noEDups.faa",
		#"config/Anantharaman2018_dsrA_dsrB_noDups.json"

include: "workflow/rules/getTreeInfo.smk"
#include: "workflow/rules/fragmentInsertion.smk"
#include: "workflow/rules/cleanHits.smk"
#include: "workflow/rules/runHMMER.smk"
#include: "workflow/rules/downloadMetagenomicData.smk"
#include: "workflow/rules/prepAnantharaman.smk"
